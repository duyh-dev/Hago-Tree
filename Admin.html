<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chi tiáº¿t bÃ i Ä‘Äƒng</title>
    <link rel="stylesheet" href="CSS/baidang.css" /><link rel="stylesheet" href="CSS/SanPham.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      if (sessionStorage.getItem("adminLoggedIn") !== "true") {
  alert("Báº¡n chÆ°a Ä‘Äƒng nháº­p hoáº·c phiÃªn Ä‘Ã£ háº¿t.");
  const email = prompt("Username");
  const password = prompt("Key");
  fetch("https://dssc.hagotree.site/admin", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      loginEmail: email,
      loginPassword: password
    })
  })
    .then((res) =>
      res.json().then((data) => ({
        status: res.status,
        body: data
      }))
    )
    .then(({ status, body }) => {
      if (status === 202) {
        sessionStorage.setItem("adminLoggedIn", "true");
        alert("ÄÄƒng nháº­p thÃ nh cÃ´ng!");
      } else {
        alert("Sai email hoáº·c máº­t kháº©u");
         window.location.href = "/Admin.html";
      }
    })
    .catch((err) => {
      console.error("Lá»—i:", err);
      alert("Lá»—i káº¿t ná»‘i tá»›i server");
    });

}

    </script>
<link rel="stylesheet" href="CSS/index.css" />
<style>
    table {
      border-collapse: collapse;
      width: 100%;
    }
    th, td {
      padding: 8px;
      border: 1px solid #ccc;
    }
    th {
      background: #f2f2f2;
    }
  </style>
  </head>
  <header class="main-header">
  <div class="top-header">
    <div class="header-left">
      <a href="index.html"><img src="IMG/logo.png" alt="logo" class="logo-hago"/></a>
    </div>

    <div class="search-container">
      <span class="search-icon">ğŸ”</span>
      <input class="searchbox" type="search" placeholder="TÃ¬m kiáº¿m..." />
    </div>

    <div class="right-icons">
      <a href="HTML/LienHe.html" class="icon-link"><img src="IMG/HAGOLH.png" /><span>LiÃªn há»‡</span></a>
      <a href="GioHang.html" class="icon-link"><img src="IMG/HAGOGH.png" /><span>Giá» hÃ ng</span><span class="cart-count"></span></a>
      <a href="HTML/dangnhap.html" class="icon-link"><img src="IMG/HAGOTK.png" /><span id="Accountchecker">ÄÄƒng nháº­p/Ä‘Äƒng kÃ½</span></a>
    </div>
  </div>

    </header>
    <br><hr>  
<h3>GIAO Dá»ŠCH</h3>
<button id="toggleDonHang" class="btn btn-primary">Xem Ä‘Æ¡n hÃ ng</button>
<div id="donHangContainer" style="display: none;">
  <div style="max-height: 300px; max-width: 70%; overflow-y: auto;" class="container">
    <table id="DonHangTable">
      <tr>
        <th>Há» tÃªn</th>
        <th>Email</th>
        <th>Äiá»‡n thoáº¡i</th>
        <th>Äá»‹a chá»‰</th>
        <th>Ghi chÃº</th>
        <th>MÃ£ giao dá»‹ch</th>
        <th>Tráº¡ng thÃ¡i Ä‘Æ¡n</th>
        <th>Tá»‰nh/TP</th>
        <th>Sáº£n pháº©m</th>
        <th>Thá»i gian Ä‘áº·t</th>
         <th>Thá»i gian giao</th>
      </tr>
    </table>
  </div>
</div>


<h3>XÃC NHáº¬N ÄÆ N</h3>
 
<button id="toggleGiaoDich" class="btn btn-primary">Xem Ä‘Æ¡n hÃ ng</button>
<div id="GiaoDichContainer" style="display: none;">
  <main class="form-container">
 <form id="xndform">
    <label for="title">MÃƒ GIAO Dá»ŠCH Cáº¦N THá»°C HIá»†N</label>
    <input type="text" id="MaGiaoDich" name="MaGiaoDich" required />
    <select id="chonxacnhan" required>
    <option selected value="xn" selected>XÃ¡c nháº­n Ä‘Æ¡n</option>
     <option value="ht" >ÄÃ£ hoÃ n thÃ nh</option>
    <option value="hd" >Há»§y Ä‘Æ¡n</option>
    <option value="xd" >XÃ³a Ä‘Æ¡n</option>
     <option value="tg" >Thá»i gian giao Ä‘Æ¡n</option>
  </select>
    <button type="submit">XÃC NHáº¬N ÄÆ N</button>
</form>

</main>
</div>
 <br><hr>
<h3>LIÃŠN Há»†</h3>
<button id="toggleLienHe" class="btn btn-primary">Xem LiÃªn Há»‡</button>
<div id="LienHeContainer" style="display: none;">
<div style="max-height: 300px;max-width: 60%; overflow-y: auto; "><table id="LienHeTable">

      <tr>
        <th>Há» tÃªn</th>
        <th>Email</th>
        <th>Äiá»‡n thoáº¡i</th>
        <th>Lá»i nháº¯n</th>
      </tr>
    </table></div>

</div>
    <br><hr>
<h3>FeedBack Sáº£n Pháº©m</h3>
<button id="toggleFeedBack" class="btn btn-primary">Xem FeedBack</button>
<div id="FeedBackContainer" style="display: none;">
<div> <br><hr>
  <div style="max-height: 300px;max-width: 60%; overflow-y: auto; "><table id="FeedBackTable">
      <tr>
        <th>Sáº£n pháº©m</th>
        <th>Lá»i nháº¯n</th>
        <th>Email ngÆ°á»i gá»­i</th>
        <th>áº¢nh</th>
        <th>Sao</th>
      </tr>
    </table></div>
</div>

</div>
 <br><hr>
<button id="toggleBaiViet" class="btn btn-primary">Xem BÃ i Viáº¿t</button>
<div id="BaiVietContainer" style="display: none;">
<div style="max-height: 500px;max-width: 50%;  overflow-y: auto; ">
  <iframe style="border:none;" src="https://mmqstore.io.vn/wp/posthaogtree" height ="500px"width="90%"></iframe>
</div>  <br><hr>
<main class="form-container">
    <form id="postForm">
      <label for="title">TÃªn sáº£n pháº©m:</label>
      <input type="text" id="title" name="title" required />

      <label for="image">áº¢nh minh há»a:</label>
      <input type="file" id="image" name="image" accept="image/*" />
      <label for="title">GÃ­a sáº£n pháº©m:</label>
      <input type="number" id="cost" name="cost" required />

      <label for="content">MiÃªu táº£ sáº£n pháº©m:</label>
      <textarea id="content" name="content" rows="10" required></textarea>
      <label for="content">Chá»n tag cho sáº£n pháº©m:</label>
       <select id="tag_product" name="tag" required>
      <option selected value="caycanhnhantao" selected>CÃ¢y cáº£nh nhÃ¢n táº¡o</option>
       <option value="chaucay" >Cháº­u cÃ¢y</option>
      <option value="combochaucay" >Combo cÃ¢y cháº­u</option>
      <option value="caycanh" >CÃ¢y cáº£nh</option>
    </select>
      <button type="submit">ÄÄƒng bÃ i</button>
    </form>

  <div id="successMessage" style="display: none;">
    BÃ i viáº¿t Ä‘Ã£ Ä‘Æ°á»£c lÆ°u! Báº¡n cÃ³ thá»ƒ xem láº¡i trong danh sÃ¡ch bÃ i Ä‘Äƒng.
  </div>
</main>
</div>



  </body>
   <footer>
  <div class="footer-container">
    <div class="footer-section">
      <h2>Hago Tree</h2>
      <p>ChuyÃªn cÃ¢y cáº£nh nhÃ¢n táº¡o tháº©m má»¹ â€“ Äáº¹p bá»n vá»¯ng theo thá»i gian.</p>
    </div>
    <div class="footer-section">
      <h2>LiÃªn há»‡</h2>
      <p><i class="fas fa-map-marker-alt"></i> Háº»m 1581, ÄÆ°á»ng BÃ¹i Há»¯u NghÄ©a, PhÆ°á»ng TÃ¢n Háº¡nh, TP. BiÃªn HÃ²a, Äá»“ng Nai</p>
      <p><i class="fas fa-envelope"></i> HagoTree@gmail.com</p>
      <p><i class="fas fa-phone-alt"></i> 0968 123 456</p>
    </div>
    <div class="footer-section">
      <h2>Theo dÃµi</h2>
      <div class="footer-social">
        <a href="https://www.facebook.com/HagoTreee" target="_blank" aria-label="Facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
        <a href="https://zalo.me/yourZaloID" target="_blank" aria-label="Zalo">
          <img src="https://upload.wikimedia.org/wikipedia/commons/9/91/Icon_of_Zalo.svg" alt="Zalo" class="zalo-icon">
        </a>
      </div>
      <p style="margin-top:8px;font-size:13px;">Káº¿t ná»‘i vá»›i chÃºng tÃ´i Ä‘á»ƒ nháº­n Æ°u Ä‘Ã£i & tin tá»©c má»›i nháº¥t!</p>
    </div>
  </div>
  <div class="footer-quote">
    <em>â€œCÃ¢y cáº£nh giáº£, cáº£m xÃºc tháº­t.â€</em>
  </div>
  <div class="footer-bottom">
    &copy; 2025 Hago Tree. All rights reserved.
  </div>
</footer>
     <script>
       
const contentform = document.getElementById("postForm");
const xacnhanform = document.getElementById("xndform");
const thanhcongform = document.getElementById("dntcform");

contentform.addEventListener("submit", async (e) => {
  e.preventDefault();

  const formData = new FormData(contentform);
  const contentformdata = Object.fromEntries(formData.entries());

  const imageFile = contentform.image.files[0];

  if (imageFile) {
    try {
      contentformdata.image = await convertToBase64(imageFile); 
    } catch (err) {
      console.error("Lá»—i chuyá»ƒn áº£nh:", err);
      alert("KhÃ´ng thá»ƒ xá»­ lÃ½ áº£nh!");
      return;
    }
  } else {
    contentformdata.image = "";
  }

  fetch("https://dssc.hagotree.site/upload-post", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify(contentformdata),
  })
    .then((res) => {
      if (res.ok) {
        document.getElementById("successMessage").style.display = "block";
        contentform.reset();
      } else {
        alert("Lá»—i khi Ä‘Äƒng bÃ i viáº¿t!");
      }
    })
    .catch((err) => {
      console.error(err);
      alert("Lá»—i káº¿t ná»‘i Ä‘áº¿n server.");
    });
});
xacnhanform.addEventListener("submit", function (e) {
  e.preventDefault();
  const xacnhanformdata = Object.fromEntries(new FormData(xacnhanform).entries()); 
  if(chonxacnhan.value=="xn"){
    fetch('https://dssc.hagotree.site/xac-nhan-don', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(xacnhanformdata) 
  })

  .then(async (response) => {
      console.log("Status:", response.status);
      const data = await response.json().catch(() => ({}));
      console.log("Response body:", data);

      if (response.status === 201) {
        alert("Xong");
      } else {
        alert("CÃ³ lá»—i xáº£y ra, vui lÃ²ng thá»­ láº¡i.\n" + (data.message || ""));
      }
    })
    .catch((error) => {
      console.error("Fetch error:", error);
      alert("Lá»—i káº¿t ná»‘i tá»›i server!");
    });
}

else if (chonxacnhan.value == "ht") {
  fetch("https://dssc.hagotree.site/xac-nhan-don-xong", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify(xacnhanformdata),
  })
    .then(async (response) => {
      console.log("Status:", response.status);
      const data = await response.json().catch(() => ({}));
      console.log("Response body:", data);

      if (response.status === 201) {
        alert("Xong");
      } else {
        alert("CÃ³ lá»—i xáº£y ra, vui lÃ²ng thá»­ láº¡i.\n" + (data.message || ""));
      }
    })
    .catch((error) => {
      console.error("Fetch error:", error);
      alert("Lá»—i káº¿t ná»‘i tá»›i server!");
    });
}
else if (chonxacnhan.value == "tg") {
  const datattime = prompt("Nháº­p thá»i gian giao");

  const maGiaoDichx = document.getElementById("MaGiaoDich").value;

  const dataToSend = {
    thoiGianGiao: datattime,
    maGiaoDich: maGiaoDichx
  };

  fetch("https://dssc.hagotree.site/thoi-gian-giao", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify(dataToSend),
  })
    .then(async (response) => {
      console.log("Status:", response.status);
      const data = await response.json().catch(() => ({}));
      console.log("Response body:", data);

      if (response.status === 201) {
        alert("Xong");
      } else {
        alert("CÃ³ lá»—i xáº£y ra, vui lÃ²ng thá»­ láº¡i.\n" + (data.message || ""));
      }
    })
    .catch((error) => {
      console.error("Fetch error:", error);
      alert("Lá»—i káº¿t ná»‘i tá»›i server!");
    });
}

  else if(chonxacnhan.value=="hd"){
      fetch('https://dssc.hagotree.site/huy-don', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(xacnhanformdata)  
      })

      .then(async (response) => {
          console.log("Status:", response.status);
          const data = await response.json().catch(() => ({}));
          console.log("Response body:", data);

          if (response.status === 201) {
            alert("Xong");
          } else {
            alert("CÃ³ lá»—i xáº£y ra, vui lÃ²ng thá»­ láº¡i.\n" + (data.message || ""));
          }
        })
        .catch((error) => {
          console.error("Fetch error:", error);
        });
  }
   else if(chonxacnhan.value=="xd"){
      fetch('https://dssc.hagotree.site/xoa-don', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(xacnhanformdata)  
        })
            .then(async (response) => {
            console.log("Status:", response.status);
            const data = await response.json().catch(() => ({}));
            console.log("Response body:", data);

            if (response.status === 201) {
              alert("Xong");
            } else {
              alert("CÃ³ lá»—i xáº£y ra, vui lÃ²ng thá»­ láº¡i.\n" + (data.message || ""));
            }
          })
          .catch((error) => {
            console.error("Fetch error:", error);
            alert("Lá»—i káº¿t ná»‘i tá»›i server!");
          });
      }

})






function convertToBase64(file) {  //chuyá»ƒn áº£nh sang dáº¡ng byte64
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.onload = () => resolve(reader.result); 
    reader.onerror = reject;
    reader.readAsDataURL(file);
  });
}

     </script>

     <script>
let cityData = [];


fetch("https://raw.githubusercontent.com/kenzouno1/DiaGioiHanhChinhVN/master/data.json")
  .then(response => response.json()) 
  .then(data => {
    cityData = data;
    loadOrders(); 
  })
  .catch(error => {
    console.error("Lá»—i khi táº£i dá»¯ liá»‡u tá»‰nh thÃ nh:", error);
  });

function getDiaChi(dayString) {
  if (!dayString || !dayString.includes(",")) return "KhÃ´ng rÃµ";

  const [wardId, districtId, cityId] = dayString.split(",");

  const city = cityData.find(c => c.Id === cityId);
  if (!city) return "KhÃ´ng rÃµ thÃ nh phá»‘";

  const district = city.Districts.find(d => d.Id === districtId);
  if (!district) return `${city.Name}`;

  const ward = district.Wards.find(w => w.Id === wardId);
  if (!ward) return `${district.Name}, ${city.Name}`;

  return `${ward.Name}, ${district.Name}, ${city.Name}`;
}

fetch("https://dssc.hagotree.site/lh")
    .then(res => res.json())
    .then(data => {
      const tbody = document.querySelector("#LienHeTable tbody");
      data.forEach(lienhe => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${lienhe.name}</td>
          <td>${lienhe.email}</td>
          <td>${lienhe.phone}</td>
          <td>${lienhe.message}</td>
        `;
        tbody.appendChild(row);
      });
    })
    .catch(err => {
      console.error("Lá»—i khi láº¥y Ä‘Æ¡n hÃ ng:", err);
      document.body.innerHTML += "<p style='color:red;'>KhÃ´ng thá»ƒ táº£i liÃªn há»‡!</p>";
    });
fetch("https://dssc.hagotree.site/fb")
    .then(res => res.json())
    .then(data => {
      const tbody = document.querySelector("#FeedBackTable tbody");
      data.forEach(feedbackx => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${feedbackx.product}</td>
          <td>${feedbackx.feedback}</td>
          <td>${feedbackx.email}</td>
          <td><img src="https://dssc.hagotree.site/${feedbackx.image}" alt="áº¢nh Feedback" style="max-width:200px;"></td>
          <td>${feedbackx.star}</td>
        `;
        tbody.appendChild(row);
      });
    })
    .catch(err => {
      console.error("Lá»—i khi láº¥y Ä‘Æ¡n hÃ ng:", err);
      document.body.innerHTML += "<p style='color:red;'>KhÃ´ng thá»ƒ táº£i liÃªn há»‡!</p>";
    });
function loadOrders() {
  fetch("https://dssc.hagotree.site/dh")
    .then(res => res.json())
    .then(data => {
      const tbody = document.querySelector("#DonHangTable tbody");
      data.forEach(order => {
        const donHangParsed = JSON.parse(order.DonHang || "[]");
        const productList = donHangParsed.map(p => `
          <div>
            <strong>${p.name}</strong> - ${p.price.toLocaleString()}â‚« Ã— ${p.quantity}
            <br><img src="IMG/${p.image}" width="50">
          </div>
        `).join("");

        const diaChiGoc = getDiaChi(order.DiaChiTinhThanh);

        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${order.Name}</td>
          <td>${order.email}</td>
          <td>${order.phone}</td>
          <td>${order.address}</td>
          <td>${order.note}</td>
          <td>${order.MaGiaoDich}</td>
          <td>${order.Ttdon}</td>
          <td>${diaChiGoc}</td>
          <td>${productList}</td>
          <td>${order.TimeDatHang}</td>
          <td>${order.TimeNhanHang}</td>
        `;
        tbody.appendChild(row);
      });
    })
    .catch(err => {
      console.error("Lá»—i khi láº¥y Ä‘Æ¡n hÃ ng:", err);
      document.body.innerHTML += "<p style='color:red;'>KhÃ´ng thá»ƒ táº£i Ä‘Æ¡n hÃ ng!</p>";
    });
}
document.addEventListener("DOMContentLoaded", () => {
  const btn = document.getElementById("toggleDonHang");
  const btn1 = document.getElementById("toggleGiaoDich");
  const btn2 = document.getElementById("toggleLienHe");
  const btn3 = document.getElementById("toggleFeedBack");
  const btn4 = document.getElementById("toggleBaiViet");

  const donHangDiv = document.getElementById("donHangContainer");
  const giaoDichDiv = document.getElementById("GiaoDichContainer");
  const lienHeDiv = document.getElementById("LienHeContainer");
  const feedBackDiv = document.getElementById("FeedBackContainer");
  const baiVietDiv = document.getElementById("BaiVietContainer");

  btn.addEventListener("click", () => {
    toggleDiv(donHangDiv, btn, "Xem Ä‘Æ¡n hÃ ng", "áº¨n Ä‘Æ¡n hÃ ng");
  });

  btn1.addEventListener("click", () => {
    toggleDiv(giaoDichDiv, btn1, "Xem giao dá»‹ch", "áº¨n giao dá»‹ch");
  });

  btn2.addEventListener("click", () => {
    toggleDiv(lienHeDiv, btn2, "Xem liÃªn há»‡", "áº¨n liÃªn há»‡");
  });

  btn3.addEventListener("click", () => {
    toggleDiv(feedBackDiv, btn3, "Xem pháº£n há»“i", "áº¨n pháº£n há»“i");
  });

  btn4.addEventListener("click", () => {
    toggleDiv(baiVietDiv, btn4, "Xem bÃ i viáº¿t", "áº¨n bÃ i viáº¿t");
  });

  function toggleDiv(div, button, textShow, textHide) {
    if (div.style.display === "none" || div.style.display === "") {
      div.style.display = "block";
      button.textContent = textHide;
    } else {
      div.style.display = "none";
      button.textContent = textShow;
    }
  }
});

</script>

         <script src="JS/index.js"></script>
</html>
