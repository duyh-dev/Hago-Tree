const e=q;(function(U,C){const y=q,G=U();while(!![]){try{const s=-parseInt(y(0xec))/0x1+parseInt(y(0x156))/0x2*(-parseInt(y(0x10e))/0x3)+-parseInt(y(0xf0))/0x4+-parseInt(y(0x10a))/0x5+-parseInt(y(0x10b))/0x6*(parseInt(y(0x106))/0x7)+parseInt(y(0xf7))/0x8*(-parseInt(y(0x12f))/0x9)+parseInt(y(0x15e))/0xa;if(s===C)break;else G['push'](G['shift']());}catch(L){G['push'](G['shift']());}}}(O,0x52ac1));let cart=JSON[e(0x115)](localStorage['getItem']('cart'))||[],TotalPriceToSummary=0x0;var ProductWillBuy='',username=removeVietnameseTones();window['addEventListener'](e(0x15a),()=>{});var getidsummary=idsummaryCreator(username);const checkoutForm=document['getElementById'](e(0x116));function idsummaryCreator(U){const d=e,C=new Date();let G=C[d(0x131)]();return G+U;}function removeVietnameseTones(){const g=e,U=JSON[g(0x115)](localStorage[g(0x128)](g(0x137)))||[];try{if(U[g(0x12b)]>0x0&localStorage[g(0x128)]('userPassword')[g(0x12b)]>0x0){const G=U[U[g(0x12b)]-0x1];console['log'](G[g(0x145)]),document[g(0xe5)](g(0xee))[g(0x102)]=G[g(0x145)];const s=N=>Buffer[g(0x13a)](N,'base64')[g(0x10f)](g(0x125)),L=new TextEncoder()[g(0x110)](G[g(0x145)]),Q=btoa(String[g(0x14d)](...L));loadDataofUser(Q);var C=G['email'];return C[g(0xfe)](g(0xdb))['replace'](/[\u0300-\u036f]/g,'')['replace'](/đ/g,'d')[g(0x123)](/Đ/g,'D')['replace'](/[^a-zA-Z0-9\s]/g,'')[g(0x123)](/\s+/g,'\x20')[g(0x11e)]();}else alert(g(0x12c)),setTimeout(()=>{const i=g;window['location'][i(0x13b)]=i(0xf3);},0x7d0);}catch{alert(g(0x13d)),setTimeout(()=>{const k=g;window['location']['href']=k(0xf3);},0x7d0);}}function loadDataofUser(U){const t=e;fetch(t(0xe4),{'method':t(0x150),'headers':{'Content-Type':t(0x154)},'body':JSON[t(0x10d)]({'krlx':U})})['then'](C=>C[t(0x139)]())['then'](C=>{const v=t;if(!C||C[v(0x109)]){alert(v(0xe6));return;}document[v(0xe5)](v(0xf2))[v(0x132)]=C[v(0xf1)]||'',document[v(0xe5)](v(0x145))[v(0x132)]=C[v(0x12d)]||'',document['getElementById'](v(0x14f))[v(0x132)]=C['sdt']||'',document['getElementById']('address')['value']=C[v(0xff)]||'';})[t(0x149)](C=>{const R=t;console[R(0xf5)](R(0x140),C);});}function addvoucher(){const B=e,U=document[B(0xe5)](B(0x107)),C=document[B(0xe5)]('discounted-total'),G=document[B(0xe5)](B(0x117))[B(0x132)][B(0x11e)](),s=document[B(0xe5)](B(0x112))[B(0x122)];if(!G){alert(B(0xe9));return;}fetch(B(0x146),{'method':B(0x150),'headers':{'Content-Type':'application/json'},'body':JSON[B(0x10d)]({'voucherCode':G})})[B(0x12e)](L=>L[B(0x139)]())[B(0x12e)](L=>{const Z=B;if(!L['success']||!L['voucher']){alert(Z(0x144));const A=document['getElementById'](Z(0x117));A[Z(0x132)]='';return;}const Q=L['voucher'],N=Number((Q['minCost']||'')[Z(0x10f)]()[Z(0x123)](/[^\d]/g,'')),T=Number((Q['maxUsed']||'')[Z(0x10f)]()[Z(0x123)](/[^\d]/g,'')),z=Number((Q['use']||'0')[Z(0x10f)]()[Z(0x123)](/[^\d]/g,'')),l=Q[Z(0x153)],D=Number((Q['discountValue']||'')[Z(0x10f)]()[Z(0x123)](/[^\d]/g,'')),c=Number(s[Z(0x123)](/[^\d]/g,''));if(c>=N&&z<T){alert(Z(0x103));let X=c;l==Z(0x121)?(X=c-c*D/0x64,C[Z(0xe2)]=Math[Z(0x162)](c*D/0x64,0x0)['toLocaleString']()+'₫'):(X=c-D,C[Z(0xe2)]=Math[Z(0x162)](D,0x0)[Z(0x13c)]()+'₫'),U[Z(0xe2)]=Math[Z(0x162)](X,0x0)[Z(0x13c)]()+'₫',TotalPriceToSummary=X,generateQRCode();}else{alert(Z(0x119));const n=document['getElementById'](Z(0x117));n[Z(0x132)]='';}})['catch'](L=>{const p=B;console[p(0xf5)](L),alert(p(0xfa),L);const Q=document[p(0xe5)](p(0x117));Q[p(0x132)]='';});}function displayOrderSummary(){const b=e,U=document[b(0xe5)](b(0x108)),C=document[b(0xe5)](b(0x107)),G=document[b(0xe5)](b(0x112));let s=JSON[b(0x115)](localStorage[b(0x128)](b(0xf6)))||[],L=[];ProductWillBuy=JSON['stringify'](cart);let Q=0x0;U[b(0x102)]='',cart[b(0x13e)](N=>{const H=b,T=N[H(0xfd)],z=T*N[H(0x129)];Q+=z;!s[H(0xea)](N[H(0xe7)])&&L['push'](N[H(0xe7)]);const l=document[H(0x134)]('li');l['className']=H(0x155),l[H(0x102)]=H(0x138)+N[H(0xed)]+H(0x104)+N[H(0x11a)]+H(0x161)+N[H(0x11a)]+'\x20-\x20'+N[H(0x129)]+'\x20x\x20'+T['toLocaleString']()+H(0x126),U[H(0x14b)](l);}),console[b(0x124)](JSON[b(0x10d)](L)),localStorage[b(0x141)](b(0xf6),JSON[b(0x10d)](L)),G[b(0xe2)]=Q[b(0x13c)]()+'₫',TotalPriceToSummary=Q,C[b(0xe2)]=Q['toLocaleString']()+'₫',generateQRCode();}function validateCheckoutForm(U){const S=e,C=U[S(0x135)]||document['querySelector']('.checkout-container\x20form');let G=!![];C[S(0x133)](S(0xda))[S(0x13e)](L=>L[S(0x10c)][S(0x151)]('error')),[S(0x114),S(0x11b),S(0xff),'city',S(0x14f),'email']['forEach'](L=>{const j=S,Q=C[j(0x160)]('#'+L);Q&&Q[j(0xfb)]('required')&&!Q[j(0x132)][j(0x11e)]()&&(Q[j(0x10c)][j(0x15c)]('error'),G=![]);});const s=C[S(0x160)](S(0x113));s&&s[S(0x132)]&&!/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/[S(0x143)](s[S(0x132)])&&(s[S(0x10c)][S(0x15c)]('error'),G=![]);if(!G)return alert(S(0x15b)),U[S(0x118)](),![];return!![];}document['addEventListener'](e(0x15a),function(){const W=e,U=document[W(0x160)](W(0x142));U&&(U[W(0x15d)]=validateCheckoutForm);});function confirmPayment(){const o=e;localStorage[o(0x13f)](o(0xe3));}document[e(0xde)]('DOMContentLoaded',displayOrderSummary);function O(){const h=['innerText','replace','log','binary','₫\x0a\x20\x20\x20\x20','DiaChiTinhThanh','getItem','quantity','display','length','Vui\x20lòng\x20đăng\x20nhập\x20để\x20tiếp\x20tục\x20thanh\x20toán\x20!!','registerEmail','then','252EYwJVk','Ttdon','getTime','value','querySelectorAll','createElement','target','style','user','\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://dssc.hagotree.site','json','from','href','toLocaleString','Vui\x20lòng\x20đăng\x20nhập\x20để\x20tiếp\x20tục\x20thanh\x20toán\x20!!\x20-ER1','forEach','removeItem','Lỗi\x20khi\x20tải\x20dữ\x20liệu:','setItem','.checkout-container\x20form','test','Voucher\x20không\x20hợp\x20lệ\x20hoặc\x20đã\x20hết\x20hạn!','email','https://dssc.hagotree.site/use-voucher','getMonth','Sẽ\x20có\x20sau\x20khi\x20xác\x20nhận','catch','id_summary','appendChild','getDate','fromCharCode','Không\x20rõ','phone','POST','remove','Status:','discountType','application/json','cart-item-summary','22wzITcr','MaGiaoDich','none','reset','DOMContentLoaded','Vui\x20lòng\x20nhập\x20đầy\x20đủ\x20và\x20đúng\x20các\x20trường\x20bắt\x20buộc!','add','onsubmit','21026340pSWBFd','district','querySelector','\x22\x20class=\x22product-image\x22\x20style=\x22width:\x2050px;\x20height:\x2050px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20','max','input,\x20select','NFD','fromEntries','getFullYear','addEventListener','Đã\x20thanh\x20toán,\x20sẽ\x20có\x20email\x20xác\x20nhận\x20đơn!','username','src','textContent','cart','https://dssc.hagotree.site/get-user','getElementById','Không\x20tìm\x20thấy\x20người\x20dùng','name','Server\x20trả\x20về\x20lỗi:','Vui\x20lòng\x20nhập\x20mã\x20voucher.','includes','getHours','116120bYHYYC','image','Accountchecker','status','958296kTOMRy','registerName','Name','../HTML/dangnhap.html','Khách\x20hàng','error','Productbuyed','46024YvRxmH','https://dssc.hagotree.site/payment','Có\x20lỗi\x20xảy\x20ra,\x20vui\x20lòng\x20thử\x20lại.','Lỗi','hasAttribute','Response\x20body:','cost','normalize','address','&size=200x200','flex','innerHTML','Voucher\x20được\x20áp\x20dụng','\x22\x20alt=\x22','entries','1051043YfYInC','cart-total-summary-voucher','cart-items-summary','message','893305txmflZ','18DOKnpb','classList','stringify','168579IexiQh','toString','encode','TimeNhanHang','cart-total-summary','#email','firstName','parse','CheckoutForm','voucher-code','preventDefault','Không\x20thể\x20áp\x20dụng\x20voucher\x20này.\x0aCó\x20thể\x20do\x20chưa\x20đủ\x20giá\x20trị\x20đơn\x20hàng\x20hoặc\x20đã\x20hết\x20lượt\x20dùng.','title','lastName','getMinutes','DonHang','trim','submit','ward','per'];O=function(){return h;};return O();}function generateQRCode(){const x=e,U=document['getElementById']('qr-code-image');U[x(0xe1)]='https://img.vietqr.io/image/MB-0336735887-qr_only.png?amount='+TotalPriceToSummary+'&addInfo='+getidsummary+x(0x100),console['log'](username),document[x(0xe5)](x(0x14a))['innerText']=getidsummary,console['log'](ProductWillBuy);}function q(U,C){const G=O();return q=function(s,L){s=s-0xda;let Q=G[s];return Q;},q(U,C);}checkoutForm[e(0xde)](e(0x11f),function(U){const f=e;U[f(0x118)]();const C=new Date(),G=C[f(0xeb)]()+':'+C[f(0x11c)]()+'\x20'+C[f(0x14c)]()+'/'+(C[f(0x147)]()+0x1)+'/'+C[f(0xdd)]();console[f(0x124)](G);const s=Object[f(0xdc)](new FormData(checkoutForm)[f(0x105)]());s[f(0x11d)]=ProductWillBuy;const L=document[f(0xe5)]('city')[f(0x132)],Q=document['getElementById'](f(0x15f))[f(0x132)],N=document[f(0xe5)](f(0x120))['value'];s[f(0x157)]=getidsummary,s[f(0x130)]='Chờ\x20xác\x20nhận',s['TimeDatHang']=G,s[f(0x111)]=f(0x148),s[f(0x127)]=N+','+Q+','+L,fetch(f(0xf8),{'method':'POST','headers':{'Content-Type':f(0x154)},'body':JSON[f(0x10d)](s)})[f(0x12e)](T=>{const F=f;if(T[F(0xef)]===0xc9){const z=document[F(0xe5)]('voucher-code')[F(0x132)][F(0x11e)]();alert(F(0xdf)),fetch('https://dssc.hagotree.site/used-voucher',{'method':F(0x150),'headers':{'Content-Type':F(0x154)},'body':JSON[F(0x10d)]({'voucherCode':z})})[F(0x12e)](async l=>{const M=F;console[M(0x124)](M(0x152),l[M(0xef)]);const D=await l[M(0x139)]()['catch'](()=>({}));console[M(0x124)](M(0xfc),D),l[M(0xef)]===0xc9?console[M(0x124)]('OK'):console[M(0xf5)](M(0xe8),D[M(0x109)]||M(0x14e));})[F(0x149)](l=>{const Y=F;console[Y(0xf5)]('Fetch\x20error:',l),alert('Lỗi\x20kết\x20nối\x20tới\x20server!');}),showPaymentSuccessModal(),checkoutForm[F(0x159)](),confirmPayment();}else alert(F(0xf9));});});function showPaymentSuccessModal(){const m=e;var U=document[m(0xe5)]('payment-success-modal'),C=localStorage[m(0x128)](m(0xe0))||m(0xf4);document[m(0xe5)]('modal-username')[m(0xe2)]=C,U[m(0x136)][m(0x12a)]=m(0x101);}function closeSuccessModal(){const a=e;document['getElementById']('payment-success-modal')[a(0x136)][a(0x12a)]=a(0x158);}
