const _0x3e4e81=_0x3b56;(function(_0x161b41,_0x522db2){const _0x3e2b66=_0x3b56,_0x1180f9=_0x161b41();while(!![]){try{const _0x302e7d=parseInt(_0x3e2b66(0x246))/0x1+-parseInt(_0x3e2b66(0x1e5))/0x2+-parseInt(_0x3e2b66(0x24e))/0x3+-parseInt(_0x3e2b66(0x227))/0x4+parseInt(_0x3e2b66(0x20c))/0x5*(-parseInt(_0x3e2b66(0x1fb))/0x6)+-parseInt(_0x3e2b66(0x1dc))/0x7+parseInt(_0x3e2b66(0x235))/0x8*(parseInt(_0x3e2b66(0x213))/0x9);if(_0x302e7d===_0x522db2)break;else _0x1180f9['push'](_0x1180f9['shift']());}catch(_0x265c76){_0x1180f9['push'](_0x1180f9['shift']());}}}(_0x49a9,0x4d669));let cart=JSON[_0x3e4e81(0x1cc)](localStorage[_0x3e4e81(0x1d8)](_0x3e4e81(0x233)))||[],TotalPriceToSummary=0x0;var ProductWillBuy='',username=removeVietnameseTones();window['addEventListener'](_0x3e4e81(0x1fc),()=>{});var getidsummary=idsummaryCreator(username);const checkoutForm=document[_0x3e4e81(0x1e8)](_0x3e4e81(0x242));function idsummaryCreator(_0x3d9590){const _0x1c35be=_0x3e4e81,_0x36691f=new Date();let _0x5a81ba=_0x36691f[_0x1c35be(0x21c)]();return _0x5a81ba+_0x3d9590;}function _0x3b56(_0x1c1752,_0x2b6c0c){const _0x49a9d3=_0x49a9();return _0x3b56=function(_0x3b5607,_0x2d7aa8){_0x3b5607=_0x3b5607-0x1cc;let _0xf56fe0=_0x49a9d3[_0x3b5607];return _0xf56fe0;},_0x3b56(_0x1c1752,_0x2b6c0c);}function removeVietnameseTones(){const _0x29b6de=_0x3e4e81,_0x506452=JSON[_0x29b6de(0x1cc)](localStorage[_0x29b6de(0x1d8)](_0x29b6de(0x245)))||[];try{if(_0x506452['length']>0x0&localStorage['getItem'](_0x29b6de(0x21f))[_0x29b6de(0x219)]>0x0){const _0x2efd14=_0x506452[_0x506452[_0x29b6de(0x219)]-0x1];console[_0x29b6de(0x1e2)](_0x2efd14[_0x29b6de(0x1f1)]),document[_0x29b6de(0x1e8)](_0x29b6de(0x1eb))['innerHTML']=_0x2efd14['email'];const _0xe15a83=_0x6ee831=>Buffer[_0x29b6de(0x232)](_0x6ee831,_0x29b6de(0x21d))[_0x29b6de(0x1db)](_0x29b6de(0x1ff)),_0x3e9944=new TextEncoder()[_0x29b6de(0x239)](_0x2efd14[_0x29b6de(0x1f1)]),_0x444d64=btoa(String[_0x29b6de(0x226)](..._0x3e9944));loadDataofUser(_0x444d64);var _0x632b14=_0x2efd14[_0x29b6de(0x1f1)];return _0x632b14['normalize'](_0x29b6de(0x1f0))[_0x29b6de(0x248)](/[\u0300-\u036f]/g,'')[_0x29b6de(0x248)](/đ/g,'d')[_0x29b6de(0x248)](/Đ/g,'D')[_0x29b6de(0x248)](/[^a-zA-Z0-9\s]/g,'')[_0x29b6de(0x248)](/\s+/g,'\x20')['trim']();}else alert('Vui\x20lòng\x20đăng\x20nhập\x20để\x20tiếp\x20tục\x20thanh\x20toán\x20!!'),setTimeout(()=>{const _0x3b96e6=_0x29b6de;window[_0x3b96e6(0x20e)]['href']=_0x3b96e6(0x200);},0x7d0);}catch{alert(_0x29b6de(0x238)),setTimeout(()=>{const _0x3e6a32=_0x29b6de;window['location'][_0x3e6a32(0x22c)]=_0x3e6a32(0x200);},0x7d0);}}function loadDataofUser(_0x137a73){const _0x5d456b=_0x3e4e81;fetch('https://dssc.hagotree.site/get-user',{'method':_0x5d456b(0x1e0),'headers':{'Content-Type':_0x5d456b(0x251)},'body':JSON[_0x5d456b(0x20b)]({'krlx':_0x137a73})})[_0x5d456b(0x1d0)](_0x3b1393=>_0x3b1393['json']())[_0x5d456b(0x1d0)](_0x165eb6=>{const _0x1049e8=_0x5d456b;if(!_0x165eb6||_0x165eb6['message']){alert(_0x1049e8(0x216));return;}document[_0x1049e8(0x1e8)](_0x1049e8(0x1f8))[_0x1049e8(0x231)]=_0x165eb6[_0x1049e8(0x241)]||'',document['getElementById'](_0x1049e8(0x1f1))[_0x1049e8(0x231)]=_0x165eb6['registerEmail']||'',document['getElementById'](_0x1049e8(0x21a))['value']=_0x165eb6['sdt']||'',document[_0x1049e8(0x1e8)](_0x1049e8(0x221))['value']=_0x165eb6['address']||'';})[_0x5d456b(0x207)](_0x1f5d5d=>{const _0x136cbd=_0x5d456b;console[_0x136cbd(0x1fe)](_0x136cbd(0x240),_0x1f5d5d);});}function addvoucher(){const _0x335332=_0x3e4e81,_0x3df014=document[_0x335332(0x1e8)](_0x335332(0x212)),_0x1e951e=document[_0x335332(0x1e8)](_0x335332(0x23e)),_0x1af27d=document[_0x335332(0x1e8)](_0x335332(0x228))[_0x335332(0x231)][_0x335332(0x1e7)](),_0x4f8a6e=document['getElementById'](_0x335332(0x1f7))['innerText'];if(!_0x1af27d){alert(_0x335332(0x218));return;}fetch(_0x335332(0x1d6),{'method':'POST','headers':{'Content-Type':_0x335332(0x251)},'body':JSON['stringify']({'voucherCode':_0x1af27d})})['then'](_0x3bd6eb=>_0x3bd6eb['json']())['then'](_0x2daa70=>{const _0x6c004e=_0x335332;if(!_0x2daa70['success']||!_0x2daa70[_0x6c004e(0x1d1)]){alert('Voucher\x20không\x20hợp\x20lệ\x20hoặc\x20đã\x20hết\x20hạn!');return;}const _0x28d59e=_0x2daa70[_0x6c004e(0x1d1)],_0x183097=Number((_0x28d59e[_0x6c004e(0x23b)]||'')[_0x6c004e(0x1db)]()['replace'](/[^\d]/g,'')),_0x11dfb0=Number((_0x28d59e[_0x6c004e(0x1cd)]||'')[_0x6c004e(0x1db)]()[_0x6c004e(0x248)](/[^\d]/g,'')),_0x1f7ee0=Number((_0x28d59e[_0x6c004e(0x215)]||'0')[_0x6c004e(0x1db)]()[_0x6c004e(0x248)](/[^\d]/g,'')),_0x50c737=_0x28d59e[_0x6c004e(0x1d9)],_0x1a7f1a=Number((_0x28d59e[_0x6c004e(0x20a)]||'')[_0x6c004e(0x1db)]()[_0x6c004e(0x248)](/[^\d]/g,'')),_0x801a9b=Number(_0x4f8a6e['replace'](/[^\d]/g,''));if(_0x801a9b>=_0x183097&&_0x1f7ee0<_0x11dfb0){alert(_0x6c004e(0x205));let _0x203fcb=_0x801a9b;_0x50c737==_0x6c004e(0x1e6)?(_0x203fcb=_0x801a9b-_0x801a9b*_0x1a7f1a/0x64,_0x1e951e[_0x6c004e(0x230)]=Math[_0x6c004e(0x20d)](_0x801a9b*_0x1a7f1a/0x64,0x0)[_0x6c004e(0x1fa)]()+'₫'):(_0x203fcb=_0x801a9b-_0x1a7f1a,_0x1e951e[_0x6c004e(0x230)]=Math[_0x6c004e(0x20d)](_0x1a7f1a,0x0)[_0x6c004e(0x1fa)]()+'₫'),_0x3df014[_0x6c004e(0x230)]=Math['max'](_0x203fcb,0x0)[_0x6c004e(0x1fa)]()+'₫',TotalPriceToSummary=_0x203fcb,generateQRCode();}else alert('Không\x20thể\x20áp\x20dụng\x20voucher\x20này.\x0aCó\x20thể\x20do\x20chưa\x20đủ\x20giá\x20trị\x20đơn\x20hàng\x20hoặc\x20đã\x20hết\x20lượt\x20dùng.');})[_0x335332(0x207)](_0x455544=>{const _0x519691=_0x335332;console[_0x519691(0x1fe)](_0x455544),alert(_0x519691(0x1d2),_0x455544);});}function displayOrderSummary(){const _0x2d6d50=_0x3e4e81,_0x510616=document[_0x2d6d50(0x1e8)]('cart-items-summary'),_0x5164e2=document[_0x2d6d50(0x1e8)](_0x2d6d50(0x212)),_0x553a9d=document[_0x2d6d50(0x1e8)](_0x2d6d50(0x1f7));let _0x3e8fa7=JSON[_0x2d6d50(0x1cc)](localStorage[_0x2d6d50(0x1d8)](_0x2d6d50(0x1f3)))||[],_0x38d5b0=[];ProductWillBuy=JSON[_0x2d6d50(0x20b)](cart);let _0x41ed30=0x0;_0x510616[_0x2d6d50(0x209)]='',cart['forEach'](_0x171082=>{const _0x187d81=_0x2d6d50,_0x5a8160=_0x171082[_0x187d81(0x24d)],_0x5841c5=_0x5a8160*_0x171082[_0x187d81(0x220)];_0x41ed30+=_0x5841c5;!_0x3e8fa7[_0x187d81(0x201)](_0x171082[_0x187d81(0x1da)])&&_0x38d5b0[_0x187d81(0x1ea)](_0x171082[_0x187d81(0x1da)]);const _0x22b575=document['createElement']('li');_0x22b575[_0x187d81(0x1f6)]=_0x187d81(0x1e1),_0x22b575[_0x187d81(0x209)]=_0x187d81(0x214)+_0x171082['image']+_0x187d81(0x252)+_0x171082[_0x187d81(0x250)]+_0x187d81(0x225)+_0x171082['title']+_0x187d81(0x236)+_0x171082[_0x187d81(0x220)]+_0x187d81(0x202)+_0x5a8160[_0x187d81(0x1fa)]()+_0x187d81(0x1de),_0x510616[_0x187d81(0x1ee)](_0x22b575);}),console[_0x2d6d50(0x1e2)](JSON[_0x2d6d50(0x20b)](_0x38d5b0)),localStorage[_0x2d6d50(0x1d7)](_0x2d6d50(0x1f3),JSON[_0x2d6d50(0x20b)](_0x38d5b0)),_0x553a9d[_0x2d6d50(0x230)]=_0x41ed30[_0x2d6d50(0x1fa)]()+'₫',TotalPriceToSummary=_0x41ed30,_0x5164e2[_0x2d6d50(0x230)]=_0x41ed30['toLocaleString']()+'₫',generateQRCode();}function validateCheckoutForm(_0x191ffa){const _0x26ae27=_0x3e4e81,_0x1d3ab0=_0x191ffa[_0x26ae27(0x237)]||document['querySelector']('.checkout-container\x20form');let _0x1495e5=!![];_0x1d3ab0['querySelectorAll'](_0x26ae27(0x22f))[_0x26ae27(0x249)](_0x517818=>_0x517818[_0x26ae27(0x203)]['remove'](_0x26ae27(0x1fe))),[_0x26ae27(0x20f),_0x26ae27(0x1ec),'address',_0x26ae27(0x24f),'phone','email'][_0x26ae27(0x249)](_0x3f91bb=>{const _0x1f1e49=_0x26ae27,_0x323d9a=_0x1d3ab0[_0x1f1e49(0x243)]('#'+_0x3f91bb);_0x323d9a&&_0x323d9a[_0x1f1e49(0x1d5)]('required')&&!_0x323d9a[_0x1f1e49(0x231)]['trim']()&&(_0x323d9a[_0x1f1e49(0x203)][_0x1f1e49(0x1fd)](_0x1f1e49(0x1fe)),_0x1495e5=![]);});const _0x48bf75=_0x1d3ab0[_0x26ae27(0x243)]('#email');_0x48bf75&&_0x48bf75[_0x26ae27(0x231)]&&!/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/[_0x26ae27(0x247)](_0x48bf75['value'])&&(_0x48bf75[_0x26ae27(0x203)][_0x26ae27(0x1fd)](_0x26ae27(0x1fe)),_0x1495e5=![]);if(!_0x1495e5)return alert(_0x26ae27(0x206)),_0x191ffa[_0x26ae27(0x1ce)](),![];return!![];}document[_0x3e4e81(0x224)](_0x3e4e81(0x1fc),function(){const _0x27424a=_0x3e4e81,_0x59d692=document[_0x27424a(0x243)](_0x27424a(0x210));_0x59d692&&(_0x59d692[_0x27424a(0x21b)]=validateCheckoutForm);});function confirmPayment(){const _0x1e9ab0=_0x3e4e81;localStorage['removeItem'](_0x1e9ab0(0x233));}document['addEventListener'](_0x3e4e81(0x1fc),displayOrderSummary);function _0x49a9(){const _0xd0ac2a=['Chờ\x20xác\x20nhận','TimeDatHang','src','cost','1562448CCxJMk','city','title','application/json','\x22\x20alt=\x22','parse','maxUsed','preventDefault','entries','then','voucher','Lỗi','status','payment-success-modal','hasAttribute','https://dssc.hagotree.site/use-voucher','setItem','getItem','discountType','name','toString','4347371GsZxxC','Khách\x20hàng','₫\x0a\x20\x20\x20\x20','DiaChiTinhThanh','POST','cart-item-summary','log','none','json','257692YogxOx','per','trim','getElementById','ward','push','Accountchecker','lastName','id_summary','appendChild','fromEntries','NFD','email','Status:','Productbuyed','DonHang','https://dssc.hagotree.site/used-voucher','className','cart-total-summary','Name','message','toLocaleString','3078EqXWxP','DOMContentLoaded','add','error','binary','../HTML/dangnhap.html','includes','\x20x\x20','classList','Không\x20rõ','Voucher\x20được\x20áp\x20dụng','Vui\x20lòng\x20nhập\x20đầy\x20đủ\x20và\x20đúng\x20các\x20trường\x20bắt\x20buộc!','catch','Response\x20body:','innerHTML','discountValue','stringify','1520NcDfbl','max','location','firstName','.checkout-container\x20form','Sẽ\x20có\x20sau\x20khi\x20xác\x20nhận','cart-total-summary-voucher','14646798zwSGPb','\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://dssc.hagotree.site','use','Không\x20tìm\x20thấy\x20người\x20dùng','TimeNhanHang','Vui\x20lòng\x20nhập\x20mã\x20voucher.','length','phone','onsubmit','getTime','base64','username','userPassword','quantity','address','display','getDate','addEventListener','\x22\x20class=\x22product-image\x22\x20style=\x22width:\x2050px;\x20height:\x2050px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20','fromCharCode','1237060qBnvLV','voucher-code','flex','submit','reset','href','district','MaGiaoDich','input,\x20select','textContent','value','from','cart','getFullYear','8wjfSjg','\x20-\x20','target','Vui\x20lòng\x20đăng\x20nhập\x20để\x20tiếp\x20tục\x20thanh\x20toán\x20!!\x20-ER1','encode','https://img.vietqr.io/image/MB-0336735887-qr_only.png?amount=','minCost','Ttdon','Có\x20lỗi\x20xảy\x20ra,\x20vui\x20lòng\x20thử\x20lại.','discounted-total','modal-username','Lỗi\x20khi\x20tải\x20dữ\x20liệu:','registerName','CheckoutForm','querySelector','Server\x20trả\x20về\x20lỗi:','user','425543WVLwAH','test','replace','forEach'];_0x49a9=function(){return _0xd0ac2a;};return _0x49a9();}function generateQRCode(){const _0xa4399c=_0x3e4e81,_0x36dcd8=document[_0xa4399c(0x1e8)]('qr-code-image');_0x36dcd8[_0xa4399c(0x24c)]=_0xa4399c(0x23a)+TotalPriceToSummary+'&addInfo='+getidsummary+'&size=200x200',console['log'](username),document[_0xa4399c(0x1e8)](_0xa4399c(0x1ed))['innerText']=getidsummary,console[_0xa4399c(0x1e2)](ProductWillBuy);}checkoutForm[_0x3e4e81(0x224)](_0x3e4e81(0x22a),function(_0x4c0ace){const _0x3c3257=_0x3e4e81;_0x4c0ace[_0x3c3257(0x1ce)]();const _0x5821d1=new Date(),_0x47d3c4=_0x5821d1['getHours']()+':'+_0x5821d1['getMinutes']()+'\x20'+_0x5821d1[_0x3c3257(0x223)]()+'/'+(_0x5821d1['getMonth']()+0x1)+'/'+_0x5821d1[_0x3c3257(0x234)]();console[_0x3c3257(0x1e2)](_0x47d3c4);const _0x226b20=Object[_0x3c3257(0x1ef)](new FormData(checkoutForm)[_0x3c3257(0x1cf)]());_0x226b20[_0x3c3257(0x1f4)]=ProductWillBuy;const _0x576bde=document[_0x3c3257(0x1e8)]('city')['value'],_0x1c6bf3=document[_0x3c3257(0x1e8)](_0x3c3257(0x22d))[_0x3c3257(0x231)],_0x8ced29=document[_0x3c3257(0x1e8)](_0x3c3257(0x1e9))['value'];_0x226b20[_0x3c3257(0x22e)]=getidsummary,_0x226b20[_0x3c3257(0x23c)]=_0x3c3257(0x24a),_0x226b20[_0x3c3257(0x24b)]=_0x47d3c4,_0x226b20[_0x3c3257(0x217)]=_0x3c3257(0x211),_0x226b20[_0x3c3257(0x1df)]=_0x8ced29+','+_0x1c6bf3+','+_0x576bde,fetch('https://dssc.hagotree.site/payment',{'method':'POST','headers':{'Content-Type':_0x3c3257(0x251)},'body':JSON[_0x3c3257(0x20b)](_0x226b20)})[_0x3c3257(0x1d0)](_0x2d3377=>{const _0x1291ad=_0x3c3257;if(_0x2d3377[_0x1291ad(0x1d3)]===0xc9){const _0x278a70=document['getElementById']('voucher-code')[_0x1291ad(0x231)][_0x1291ad(0x1e7)]();alert('Đã\x20thanh\x20toán,\x20sẽ\x20có\x20email\x20xác\x20nhận\x20đơn!'),fetch(_0x1291ad(0x1f5),{'method':_0x1291ad(0x1e0),'headers':{'Content-Type':_0x1291ad(0x251)},'body':JSON[_0x1291ad(0x20b)]({'voucherCode':_0x278a70})})[_0x1291ad(0x1d0)](async _0x324225=>{const _0x476c96=_0x1291ad;console[_0x476c96(0x1e2)](_0x476c96(0x1f2),_0x324225[_0x476c96(0x1d3)]);const _0x1c7e57=await _0x324225[_0x476c96(0x1e4)]()['catch'](()=>({}));console[_0x476c96(0x1e2)](_0x476c96(0x208),_0x1c7e57),_0x324225[_0x476c96(0x1d3)]===0xc9?console[_0x476c96(0x1e2)]('OK'):console['error'](_0x476c96(0x244),_0x1c7e57[_0x476c96(0x1f9)]||_0x476c96(0x204));})[_0x1291ad(0x207)](_0x43073b=>{console['error']('Fetch\x20error:',_0x43073b),alert('Lỗi\x20kết\x20nối\x20tới\x20server!');}),showPaymentSuccessModal(),checkoutForm[_0x1291ad(0x22b)](),confirmPayment();}else alert(_0x1291ad(0x23d));});});function showPaymentSuccessModal(){const _0x343e89=_0x3e4e81;var _0x222f8c=document[_0x343e89(0x1e8)](_0x343e89(0x1d4)),_0x3c2e14=localStorage[_0x343e89(0x1d8)](_0x343e89(0x21e))||_0x343e89(0x1dd);document[_0x343e89(0x1e8)](_0x343e89(0x23f))[_0x343e89(0x230)]=_0x3c2e14,_0x222f8c['style'][_0x343e89(0x222)]=_0x343e89(0x229);}function closeSuccessModal(){const _0x3f54c1=_0x3e4e81;document[_0x3f54c1(0x1e8)]('payment-success-modal')['style'][_0x3f54c1(0x222)]=_0x3f54c1(0x1e3);}